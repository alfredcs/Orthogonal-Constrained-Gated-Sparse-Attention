2026-01-13 23:11:17 - INFO - __main__ - Wandb initialized: https://wandb.ai/alfredcs_team/orthgsa-qwen3-4b/runs/3r7tayas
2026-01-13 23:11:17 - INFO - __main__ - Loading model: Qwen/Qwen3-4B-Instruct-2507
2026-01-13 23:11:17 - INFO - orthgsa.models.orthgsa_model - Loading base model: Qwen/Qwen3-4B-Instruct-2507
`torch_dtype` is deprecated! Use `dtype` instead!
Loading checkpoint shards: 100%|███████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████| 3/3 [00:00<00:00, 71.67it/s]
2026-01-13 23:11:18 - INFO - orthgsa.models.orthgsa_model - OrthGSA model initialized with 4 streams
2026-01-13 23:11:18 - INFO - __main__ - Model parameters: 4031.69M total, 4031.69M trainable
2026-01-13 23:11:18 - INFO - __main__ - Gradient checkpointing enabled
2026-01-13 23:11:21 - INFO - __main__ - Model wrapped with FSDP
2026-01-13 23:11:21 - INFO - orthgsa.utils.training_utils - Optimizer groups: 0 decay params, 760 no-decay params
2026-01-13 23:11:21 - INFO - orthgsa.utils.training_utils - Using fused AdamW optimizer
2026-01-13 23:11:21 - INFO - orthgsa.utils.training_utils - LR scheduler: cosine, warmup=3000, total=100000
2026-01-13 23:11:21 - INFO - orthgsa.data.slimpajama - Loading SlimPajama-627B (streaming, packed, split=train)
Resolving data files: 100%|█████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████| 59166/59166 [00:01<00:00, 51888.68it/s]
Resolving data files: 100%|█████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████| 31428/31428 [00:00<00:00, 51379.46it/s]
Resolving data files: 100%|█████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████| 31411/31411 [00:00<00:00, 51906.92it/s]
2026-01-13 23:12:49 - INFO - orthgsa.data.slimpajama - Loading SlimPajama-627B (streaming, packed, split=train)
Resolving data files: 100%|█████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████| 59166/59166 [00:01<00:00, 52978.79it/s]
Resolving data files: 100%|█████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████| 31428/31428 [00:00<00:00, 53265.59it/s]
Resolving data files: 100%|█████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████| 31411/31411 [00:00<00:00, 52705.45it/s]
2026-01-13 23:13:10 - INFO - __main__ - Starting training...
Training:   0%|                                                                                                                                                                           | 0/100000 [00:00<?, ?it/s]Traceback (most recent call last):
  File "/home/alfred/codes/Orthogonal-Constrained-Gated-Sparse-Attention/scripts/train.py", line 451, in <module>
    main()
  File "/home/alfred/codes/Orthogonal-Constrained-Gated-Sparse-Attention/scripts/train.py", line 347, in main
    batch = next(train_iterator)
            ^^^^^^^^^^^^^^^^^^^^
  File "/home/alfred/codes/Orthogonal-Constrained-Gated-Sparse-Attention/.venv/lib/python3.11/site-packages/torch/utils/data/dataloader.py", line 732, in __next__
    data = self._next_data()
           ^^^^^^^^^^^^^^^^^
  File "/home/alfred/codes/Orthogonal-Constrained-Gated-Sparse-Attention/.venv/lib/python3.11/site-packages/torch/utils/data/dataloader.py", line 1506, in _next_data
    return self._process_data(data, worker_id)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/home/alfred/codes/Orthogonal-Constrained-Gated-Sparse-Attention/.venv/lib/python3.11/site-packages/torch/utils/data/dataloader.py", line 1541, in _process_data
    data.reraise()
  File "/home/alfred/codes/Orthogonal-Constrained-Gated-Sparse-Attention/.venv/lib/python3.11/site-packages/torch/_utils.py", line 769, in reraise
    raise exception
FileNotFoundError: Caught FileNotFoundError in DataLoader worker process 0.
Original Traceback (most recent call last):
  File "/home/alfred/codes/Orthogonal-Constrained-Gated-Sparse-Attention/.venv/lib/python3.11/site-packages/torch/utils/data/_utils/worker.py", line 349, in _worker_loop
    data = fetcher.fetch(index)  # type: ignore[possibly-undefined]
           ^^^^^^^^^^^^^^^^^^^^
  File "/home/alfred/codes/Orthogonal-Constrained-Gated-Sparse-Attention/.venv/lib/python3.11/site-packages/torch/utils/data/_utils/fetch.py", line 33, in fetch
    data.append(next(self.dataset_iter))
                ^^^^^^^^^^^^^^^^^^^^^^^
  File "/home/alfred/codes/Orthogonal-Constrained-Gated-Sparse-Attention/orthgsa/data/slimpajama.py", line 207, in __iter__
    for idx, example in enumerate(self.dataset):
  File "/home/alfred/codes/Orthogonal-Constrained-Gated-Sparse-Attention/.venv/lib/python3.11/site-packages/datasets/iterable_dataset.py", line 2529, in __iter__
    yield from self._iter_pytorch()
  File "/home/alfred/codes/Orthogonal-Constrained-Gated-Sparse-Attention/.venv/lib/python3.11/site-packages/datasets/iterable_dataset.py", line 2444, in _iter_pytorch
    for key, example in ex_iterable:
  File "/home/alfred/codes/Orthogonal-Constrained-Gated-Sparse-Attention/.venv/lib/python3.11/site-packages/datasets/iterable_dataset.py", line 1719, in __iter__
    for x in self.ex_iterable:
  File "/home/alfred/codes/Orthogonal-Constrained-Gated-Sparse-Attention/.venv/lib/python3.11/site-packages/datasets/iterable_dataset.py", line 518, in __iter__
    yield from self.ex_iterable
  File "/home/alfred/codes/Orthogonal-Constrained-Gated-Sparse-Attention/.venv/lib/python3.11/site-packages/datasets/iterable_dataset.py", line 362, in __iter__
    for key, pa_table in self.generate_tables_fn(**gen_kwags):
  File "/home/alfred/codes/Orthogonal-Constrained-Gated-Sparse-Attention/.venv/lib/python3.11/site-packages/datasets/packaged_modules/json/json.py", line 114, in _generate_tables
    for file_idx, file in enumerate(itertools.chain.from_iterable(files)):
  File "/home/alfred/codes/Orthogonal-Constrained-Gated-Sparse-Attention/.venv/lib/python3.11/site-packages/datasets/utils/track.py", line 49, in __iter__
    for x in self.generator(*self.args):
  File "/home/alfred/codes/Orthogonal-Constrained-Gated-Sparse-Attention/.venv/lib/python3.11/site-packages/datasets/utils/file_utils.py", line 1399, in _iter_from_urlpaths
    raise FileNotFoundError(urlpath)
FileNotFoundError: zstd://example_train_4777.jsonl::hf://datasets/cerebras/SlimPajama-627B@2d0accdd58c5d5511943ca1f5ff0e3eb5e293543/train/chunk2/example_train_4777.jsonl.zst

[rank0]: Traceback (most recent call last):
[rank0]:   File "/home/alfred/codes/Orthogonal-Constrained-Gated-Sparse-Attention/scripts/train.py", line 451, in <module>
[rank0]:     main()
[rank0]:   File "/home/alfred/codes/Orthogonal-Constrained-Gated-Sparse-Attention/scripts/train.py", line 347, in main
[rank0]:     batch = next(train_iterator)
[rank0]:             ^^^^^^^^^^^^^^^^^^^^
[rank0]:   File "/home/alfred/codes/Orthogonal-Constrained-Gated-Sparse-Attention/.venv/lib/python3.11/site-packages/torch/utils/data/dataloader.py", line 732, in __next__
[rank0]:     data = self._next_data()
[rank0]:            ^^^^^^^^^^^^^^^^^
[rank0]:   File "/home/alfred/codes/Orthogonal-Constrained-Gated-Sparse-Attention/.venv/lib/python3.11/site-packages/torch/utils/data/dataloader.py", line 1506, in _next_data
[rank0]:     return self._process_data(data, worker_id)
[rank0]:            ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
[rank0]:   File "/home/alfred/codes/Orthogonal-Constrained-Gated-Sparse-Attention/.venv/lib/python3.11/site-packages/torch/utils/data/dataloader.py", line 1541, in _process_data
[rank0]:     data.reraise()
[rank0]:   File "/home/alfred/codes/Orthogonal-Constrained-Gated-Sparse-Attention/.venv/lib/python3.11/site-packages/torch/_utils.py", line 769, in reraise
[rank0]:     raise exception
[rank0]: FileNotFoundError: Caught FileNotFoundError in DataLoader worker process 0.
[rank0]: Original Traceback (most recent call last):
[rank0]:   File "/home/alfred/codes/Orthogonal-Constrained-Gated-Sparse-Attention/.venv/lib/python3.11/site-packages/torch/utils/data/_utils/worker.py", line 349, in _worker_loop
[rank0]:     data = fetcher.fetch(index)  # type: ignore[possibly-undefined]
[rank0]:            ^^^^^^^^^^^^^^^^^^^^
[rank0]:   File "/home/alfred/codes/Orthogonal-Constrained-Gated-Sparse-Attention/.venv/lib/python3.11/site-packages/torch/utils/data/_utils/fetch.py", line 33, in fetch
[rank0]:     data.append(next(self.dataset_iter))
[rank0]:                 ^^^^^^^^^^^^^^^^^^^^^^^
[rank0]:   File "/home/alfred/codes/Orthogonal-Constrained-Gated-Sparse-Attention/orthgsa/data/slimpajama.py", line 207, in __iter__
[rank0]:     for idx, example in enumerate(self.dataset):
[rank0]:   File "/home/alfred/codes/Orthogonal-Constrained-Gated-Sparse-Attention/.venv/lib/python3.11/site-packages/datasets/iterable_dataset.py", line 2529, in __iter__
[rank0]:     yield from self._iter_pytorch()
[rank0]:   File "/home/alfred/codes/Orthogonal-Constrained-Gated-Sparse-Attention/.venv/lib/python3.11/site-packages/datasets/iterable_dataset.py", line 2444, in _iter_pytorch
[rank0]:     for key, example in ex_iterable:
[rank0]:   File "/home/alfred/codes/Orthogonal-Constrained-Gated-Sparse-Attention/.venv/lib/python3.11/site-packages/datasets/iterable_dataset.py", line 1719, in __iter__
[rank0]:     for x in self.ex_iterable:
[rank0]:   File "/home/alfred/codes/Orthogonal-Constrained-Gated-Sparse-Attention/.venv/lib/python3.11/site-packages/datasets/iterable_dataset.py", line 518, in __iter__
[rank0]:     yield from self.ex_iterable
[rank0]:   File "/home/alfred/codes/Orthogonal-Constrained-Gated-Sparse-Attention/.venv/lib/python3.11/site-packages/datasets/iterable_dataset.py", line 362, in __iter__
[rank0]:     for key, pa_table in self.generate_tables_fn(**gen_kwags):
[rank0]:   File "/home/alfred/codes/Orthogonal-Constrained-Gated-Sparse-Attention/.venv/lib/python3.11/site-packages/datasets/packaged_modules/json/json.py", line 114, in _generate_tables
[rank0]:     for file_idx, file in enumerate(itertools.chain.from_iterable(files)):
[rank0]:   File "/home/alfred/codes/Orthogonal-Constrained-Gated-Sparse-Attention/.venv/lib/python3.11/site-packages/datasets/utils/track.py", line 49, in __iter__
[rank0]:     for x in self.generator(*self.args):
[rank0]:   File "/home/alfred/codes/Orthogonal-Constrained-Gated-Sparse-Attention/.venv/lib/python3.11/site-packages/datasets/utils/file_utils.py", line 1399, in _iter_from_urlpaths
[rank0]:     raise FileNotFoundError(urlpath)
[rank0]: FileNotFoundError: zstd://example_train_4777.jsonl::hf://datasets/cerebras/SlimPajama-627B@2d0accdd58c5d5511943ca1f5ff0e3eb5e293543/train/chunk2/example_train_4777.jsonl.zst
