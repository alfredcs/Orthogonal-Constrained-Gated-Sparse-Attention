2026-01-13 23:02:41 - INFO - __main__ - Wandb initialized: https://wandb.ai/alfredcs_team/orthgsa-qwen3-4b/runs/h8cdinxt
2026-01-13 23:02:42 - INFO - __main__ - Loading model: Qwen/Qwen3-4B-Instruct-2507
2026-01-13 23:02:42 - INFO - orthgsa.models.orthgsa_model - Loading base model: Qwen/Qwen3-4B-Instruct-2507
`torch_dtype` is deprecated! Use `dtype` instead!
Loading checkpoint shards: 100%|███████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████| 3/3 [00:00<00:00, 72.12it/s]
2026-01-13 23:02:42 - INFO - orthgsa.models.orthgsa_model - OrthGSA model initialized with 4 streams
2026-01-13 23:02:42 - INFO - __main__ - Model parameters: 4031.69M total, 4031.69M trainable
2026-01-13 23:02:42 - INFO - __main__ - Gradient checkpointing enabled
2026-01-13 23:02:46 - INFO - __main__ - Model wrapped with FSDP
2026-01-13 23:02:46 - INFO - orthgsa.utils.training_utils - Optimizer groups: 0 decay params, 760 no-decay params
2026-01-13 23:02:46 - INFO - orthgsa.utils.training_utils - Using fused AdamW optimizer
2026-01-13 23:02:46 - INFO - orthgsa.utils.training_utils - LR scheduler: cosine, warmup=3000, total=100000
2026-01-13 23:02:46 - INFO - orthgsa.data.slimpajama - Loading SlimPajama-627B (streaming, packed, split=train)
HTTP Error 429 thrown while requesting GET https://huggingface.co/api/datasets/cerebras/SlimPajama-627B/tree/2d0accdd58c5d5511943ca1f5ff0e3eb5e293543?expand=false&recursive=true&limit=1000&cursor=ZXlKbWFXeGxYMjVoYldVaU9pSjBjbUZwYmk5amFIVnVhemt2WlhoaGJYQnNaVjkwY21GcGJsOHlNVGd6TG1wemIyNXNMbnB6ZENJc0luUnlaV1ZmYjJsa0lqb2lOV00xWldVMU16VmhabUkwTURZeU56QTVZVGM1WWpVNU9HUXhNekJqWVRVeU5Ua3daV1UwWVNKOTo4NjAwMA%3D%3D
2026-01-13 23:03:08 - WARNING - huggingface_hub.utils._http - HTTP Error 429 thrown while requesting GET https://huggingface.co/api/datasets/cerebras/SlimPajama-627B/tree/2d0accdd58c5d5511943ca1f5ff0e3eb5e293543?expand=false&recursive=true&limit=1000&cursor=ZXlKbWFXeGxYMjVoYldVaU9pSjBjbUZwYmk5amFIVnVhemt2WlhoaGJYQnNaVjkwY21GcGJsOHlNVGd6TG1wemIyNXNMbnB6ZENJc0luUnlaV1ZmYjJsa0lqb2lOV00xWldVMU16VmhabUkwTURZeU56QTVZVGM1WWpVNU9HUXhNekJqWVRVeU5Ua3daV1UwWVNKOTo4NjAwMA%3D%3D
Retrying in 1s [Retry 1/20].
2026-01-13 23:03:08 - WARNING - huggingface_hub.utils._http - Retrying in 1s [Retry 1/20].
HTTP Error 429 thrown while requesting GET https://huggingface.co/api/datasets/cerebras/SlimPajama-627B/tree/2d0accdd58c5d5511943ca1f5ff0e3eb5e293543?expand=false&recursive=true&limit=1000&cursor=ZXlKbWFXeGxYMjVoYldVaU9pSjBjbUZwYmk5amFIVnVhemt2WlhoaGJYQnNaVjkwY21GcGJsOHlNVGd6TG1wemIyNXNMbnB6ZENJc0luUnlaV1ZmYjJsa0lqb2lOV00xWldVMU16VmhabUkwTURZeU56QTVZVGM1WWpVNU9HUXhNekJqWVRVeU5Ua3daV1UwWVNKOTo4NjAwMA%3D%3D
2026-01-13 23:03:10 - WARNING - huggingface_hub.utils._http - HTTP Error 429 thrown while requesting GET https://huggingface.co/api/datasets/cerebras/SlimPajama-627B/tree/2d0accdd58c5d5511943ca1f5ff0e3eb5e293543?expand=false&recursive=true&limit=1000&cursor=ZXlKbWFXeGxYMjVoYldVaU9pSjBjbUZwYmk5amFIVnVhemt2WlhoaGJYQnNaVjkwY21GcGJsOHlNVGd6TG1wemIyNXNMbnB6ZENJc0luUnlaV1ZmYjJsa0lqb2lOV00xWldVMU16VmhabUkwTURZeU56QTVZVGM1WWpVNU9HUXhNekJqWVRVeU5Ua3daV1UwWVNKOTo4NjAwMA%3D%3D
Retrying in 2s [Retry 2/20].
2026-01-13 23:03:10 - WARNING - huggingface_hub.utils._http - Retrying in 2s [Retry 2/20].
HTTP Error 429 thrown while requesting GET https://huggingface.co/api/datasets/cerebras/SlimPajama-627B/tree/2d0accdd58c5d5511943ca1f5ff0e3eb5e293543?expand=false&recursive=true&limit=1000&cursor=ZXlKbWFXeGxYMjVoYldVaU9pSjBjbUZwYmk5amFIVnVhemt2WlhoaGJYQnNaVjkwY21GcGJsOHlNVGd6TG1wemIyNXNMbnB6ZENJc0luUnlaV1ZmYjJsa0lqb2lOV00xWldVMU16VmhabUkwTURZeU56QTVZVGM1WWpVNU9HUXhNekJqWVRVeU5Ua3daV1UwWVNKOTo4NjAwMA%3D%3D
2026-01-13 23:03:12 - WARNING - huggingface_hub.utils._http - HTTP Error 429 thrown while requesting GET https://huggingface.co/api/datasets/cerebras/SlimPajama-627B/tree/2d0accdd58c5d5511943ca1f5ff0e3eb5e293543?expand=false&recursive=true&limit=1000&cursor=ZXlKbWFXeGxYMjVoYldVaU9pSjBjbUZwYmk5amFIVnVhemt2WlhoaGJYQnNaVjkwY21GcGJsOHlNVGd6TG1wemIyNXNMbnB6ZENJc0luUnlaV1ZmYjJsa0lqb2lOV00xWldVMU16VmhabUkwTURZeU56QTVZVGM1WWpVNU9HUXhNekJqWVRVeU5Ua3daV1UwWVNKOTo4NjAwMA%3D%3D
Retrying in 4s [Retry 3/20].
2026-01-13 23:03:12 - WARNING - huggingface_hub.utils._http - Retrying in 4s [Retry 3/20].
HTTP Error 429 thrown while requesting GET https://huggingface.co/api/datasets/cerebras/SlimPajama-627B/tree/2d0accdd58c5d5511943ca1f5ff0e3eb5e293543?expand=false&recursive=true&limit=1000&cursor=ZXlKbWFXeGxYMjVoYldVaU9pSjBjbUZwYmk5amFIVnVhemt2WlhoaGJYQnNaVjkwY21GcGJsOHlNVGd6TG1wemIyNXNMbnB6ZENJc0luUnlaV1ZmYjJsa0lqb2lOV00xWldVMU16VmhabUkwTURZeU56QTVZVGM1WWpVNU9HUXhNekJqWVRVeU5Ua3daV1UwWVNKOTo4NjAwMA%3D%3D
2026-01-13 23:03:16 - WARNING - huggingface_hub.utils._http - HTTP Error 429 thrown while requesting GET https://huggingface.co/api/datasets/cerebras/SlimPajama-627B/tree/2d0accdd58c5d5511943ca1f5ff0e3eb5e293543?expand=false&recursive=true&limit=1000&cursor=ZXlKbWFXeGxYMjVoYldVaU9pSjBjbUZwYmk5amFIVnVhemt2WlhoaGJYQnNaVjkwY21GcGJsOHlNVGd6TG1wemIyNXNMbnB6ZENJc0luUnlaV1ZmYjJsa0lqb2lOV00xWldVMU16VmhabUkwTURZeU56QTVZVGM1WWpVNU9HUXhNekJqWVRVeU5Ua3daV1UwWVNKOTo4NjAwMA%3D%3D
Retrying in 8s [Retry 4/20].
2026-01-13 23:03:16 - WARNING - huggingface_hub.utils._http - Retrying in 8s [Retry 4/20].
HTTP Error 429 thrown while requesting GET https://huggingface.co/api/datasets/cerebras/SlimPajama-627B/tree/2d0accdd58c5d5511943ca1f5ff0e3eb5e293543?expand=false&recursive=true&limit=1000&cursor=ZXlKbWFXeGxYMjVoYldVaU9pSjBjbUZwYmk5amFIVnVhemt2WlhoaGJYQnNaVjkwY21GcGJsOHlNVGd6TG1wemIyNXNMbnB6ZENJc0luUnlaV1ZmYjJsa0lqb2lOV00xWldVMU16VmhabUkwTURZeU56QTVZVGM1WWpVNU9HUXhNekJqWVRVeU5Ua3daV1UwWVNKOTo4NjAwMA%3D%3D
2026-01-13 23:03:24 - WARNING - huggingface_hub.utils._http - HTTP Error 429 thrown while requesting GET https://huggingface.co/api/datasets/cerebras/SlimPajama-627B/tree/2d0accdd58c5d5511943ca1f5ff0e3eb5e293543?expand=false&recursive=true&limit=1000&cursor=ZXlKbWFXeGxYMjVoYldVaU9pSjBjbUZwYmk5amFIVnVhemt2WlhoaGJYQnNaVjkwY21GcGJsOHlNVGd6TG1wemIyNXNMbnB6ZENJc0luUnlaV1ZmYjJsa0lqb2lOV00xWldVMU16VmhabUkwTURZeU56QTVZVGM1WWpVNU9HUXhNekJqWVRVeU5Ua3daV1UwWVNKOTo4NjAwMA%3D%3D
Retrying in 8s [Retry 5/20].
2026-01-13 23:03:24 - WARNING - huggingface_hub.utils._http - Retrying in 8s [Retry 5/20].
HTTP Error 429 thrown while requesting GET https://huggingface.co/api/datasets/cerebras/SlimPajama-627B/tree/2d0accdd58c5d5511943ca1f5ff0e3eb5e293543?expand=false&recursive=true&limit=1000&cursor=ZXlKbWFXeGxYMjVoYldVaU9pSjBjbUZwYmk5amFIVnVhemt2WlhoaGJYQnNaVjkwY21GcGJsOHlNVGd6TG1wemIyNXNMbnB6ZENJc0luUnlaV1ZmYjJsa0lqb2lOV00xWldVMU16VmhabUkwTURZeU56QTVZVGM1WWpVNU9HUXhNekJqWVRVeU5Ua3daV1UwWVNKOTo4NjAwMA%3D%3D
2026-01-13 23:03:32 - WARNING - huggingface_hub.utils._http - HTTP Error 429 thrown while requesting GET https://huggingface.co/api/datasets/cerebras/SlimPajama-627B/tree/2d0accdd58c5d5511943ca1f5ff0e3eb5e293543?expand=false&recursive=true&limit=1000&cursor=ZXlKbWFXeGxYMjVoYldVaU9pSjBjbUZwYmk5amFIVnVhemt2WlhoaGJYQnNaVjkwY21GcGJsOHlNVGd6TG1wemIyNXNMbnB6ZENJc0luUnlaV1ZmYjJsa0lqb2lOV00xWldVMU16VmhabUkwTURZeU56QTVZVGM1WWpVNU9HUXhNekJqWVRVeU5Ua3daV1UwWVNKOTo4NjAwMA%3D%3D
Retrying in 8s [Retry 6/20].
2026-01-13 23:03:32 - WARNING - huggingface_hub.utils._http - Retrying in 8s [Retry 6/20].
HTTP Error 429 thrown while requesting GET https://huggingface.co/api/datasets/cerebras/SlimPajama-627B/tree/2d0accdd58c5d5511943ca1f5ff0e3eb5e293543?expand=false&recursive=true&limit=1000&cursor=ZXlKbWFXeGxYMjVoYldVaU9pSjBjbUZwYmk5amFIVnVhemt2WlhoaGJYQnNaVjkwY21GcGJsOHlNVGd6TG1wemIyNXNMbnB6ZENJc0luUnlaV1ZmYjJsa0lqb2lOV00xWldVMU16VmhabUkwTURZeU56QTVZVGM1WWpVNU9HUXhNekJqWVRVeU5Ua3daV1UwWVNKOTo4NjAwMA%3D%3D
2026-01-13 23:03:40 - WARNING - huggingface_hub.utils._http - HTTP Error 429 thrown while requesting GET https://huggingface.co/api/datasets/cerebras/SlimPajama-627B/tree/2d0accdd58c5d5511943ca1f5ff0e3eb5e293543?expand=false&recursive=true&limit=1000&cursor=ZXlKbWFXeGxYMjVoYldVaU9pSjBjbUZwYmk5amFIVnVhemt2WlhoaGJYQnNaVjkwY21GcGJsOHlNVGd6TG1wemIyNXNMbnB6ZENJc0luUnlaV1ZmYjJsa0lqb2lOV00xWldVMU16VmhabUkwTURZeU56QTVZVGM1WWpVNU9HUXhNekJqWVRVeU5Ua3daV1UwWVNKOTo4NjAwMA%3D%3D
Retrying in 8s [Retry 7/20].
2026-01-13 23:03:40 - WARNING - huggingface_hub.utils._http - Retrying in 8s [Retry 7/20].
HTTP Error 429 thrown while requesting GET https://huggingface.co/api/datasets/cerebras/SlimPajama-627B/tree/2d0accdd58c5d5511943ca1f5ff0e3eb5e293543?expand=false&recursive=true&limit=1000&cursor=ZXlKbWFXeGxYMjVoYldVaU9pSjBjbUZwYmk5amFIVnVhemt2WlhoaGJYQnNaVjkwY21GcGJsOHlNVGd6TG1wemIyNXNMbnB6ZENJc0luUnlaV1ZmYjJsa0lqb2lOV00xWldVMU16VmhabUkwTURZeU56QTVZVGM1WWpVNU9HUXhNekJqWVRVeU5Ua3daV1UwWVNKOTo4NjAwMA%3D%3D
2026-01-13 23:03:48 - WARNING - huggingface_hub.utils._http - HTTP Error 429 thrown while requesting GET https://huggingface.co/api/datasets/cerebras/SlimPajama-627B/tree/2d0accdd58c5d5511943ca1f5ff0e3eb5e293543?expand=false&recursive=true&limit=1000&cursor=ZXlKbWFXeGxYMjVoYldVaU9pSjBjbUZwYmk5amFIVnVhemt2WlhoaGJYQnNaVjkwY21GcGJsOHlNVGd6TG1wemIyNXNMbnB6ZENJc0luUnlaV1ZmYjJsa0lqb2lOV00xWldVMU16VmhabUkwTURZeU56QTVZVGM1WWpVNU9HUXhNekJqWVRVeU5Ua3daV1UwWVNKOTo4NjAwMA%3D%3D
Retrying in 8s [Retry 8/20].
2026-01-13 23:03:48 - WARNING - huggingface_hub.utils._http - Retrying in 8s [Retry 8/20].
Resolving data files: 100%|█████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████| 59166/59166 [00:01<00:00, 49502.16it/s]
Resolving data files: 100%|█████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████| 31428/31428 [00:00<00:00, 49302.99it/s]
Resolving data files: 100%|█████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████| 31411/31411 [00:00<00:00, 49626.68it/s]
2026-01-13 23:04:27 - INFO - orthgsa.data.slimpajama - Loading SlimPajama-627B (streaming, packed, split=train)
Resolving data files: 100%|█████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████| 59166/59166 [00:01<00:00, 52384.30it/s]
Resolving data files: 100%|█████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████| 31428/31428 [00:00<00:00, 49812.26it/s]
Resolving data files: 100%|█████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████| 31411/31411 [00:00<00:00, 50433.40it/s]
2026-01-13 23:04:48 - INFO - __main__ - Starting training...
Training:   0%|                                                                                                                                                                           | 0/100000 [00:00<?, ?it/s]Traceback (most recent call last):
  File "/home/alfred/codes/Orthogonal-Constrained-Gated-Sparse-Attention/scripts/train.py", line 451, in <module>
    main()
  File "/home/alfred/codes/Orthogonal-Constrained-Gated-Sparse-Attention/scripts/train.py", line 353, in main
    step_metrics = train_step(
                   ^^^^^^^^^^^
  File "/home/alfred/codes/Orthogonal-Constrained-Gated-Sparse-Attention/scripts/train.py", line 115, in train_step
    outputs = model(
              ^^^^^^
  File "/home/alfred/codes/Orthogonal-Constrained-Gated-Sparse-Attention/.venv/lib/python3.11/site-packages/torch/nn/modules/module.py", line 1775, in _wrapped_call_impl
    return self._call_impl(*args, **kwargs)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/home/alfred/codes/Orthogonal-Constrained-Gated-Sparse-Attention/.venv/lib/python3.11/site-packages/torch/nn/modules/module.py", line 1786, in _call_impl
    return forward_call(*args, **kwargs)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/home/alfred/codes/Orthogonal-Constrained-Gated-Sparse-Attention/.venv/lib/python3.11/site-packages/torch/distributed/fsdp/fully_sharded_data_parallel.py", line 851, in forward
    output = self._fsdp_wrapped_module(*args, **kwargs)
             ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/home/alfred/codes/Orthogonal-Constrained-Gated-Sparse-Attention/.venv/lib/python3.11/site-packages/torch/nn/modules/module.py", line 1775, in _wrapped_call_impl
    return self._call_impl(*args, **kwargs)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/home/alfred/codes/Orthogonal-Constrained-Gated-Sparse-Attention/.venv/lib/python3.11/site-packages/torch/nn/modules/module.py", line 1786, in _call_impl
    return forward_call(*args, **kwargs)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/home/alfred/codes/Orthogonal-Constrained-Gated-Sparse-Attention/orthgsa/models/orthgsa_model.py", line 341, in forward
    hidden_states = mhc(hidden_states, layer_fn)
                    ^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/home/alfred/codes/Orthogonal-Constrained-Gated-Sparse-Attention/.venv/lib/python3.11/site-packages/torch/nn/modules/module.py", line 1775, in _wrapped_call_impl
    return self._call_impl(*args, **kwargs)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/home/alfred/codes/Orthogonal-Constrained-Gated-Sparse-Attention/.venv/lib/python3.11/site-packages/torch/nn/modules/module.py", line 1786, in _call_impl
    return forward_call(*args, **kwargs)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/home/alfred/codes/Orthogonal-Constrained-Gated-Sparse-Attention/orthgsa/layers/mhc.py", line 204, in forward
    H_pre, H_post, H_res = self.compute_coefficients(x)
                           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/home/alfred/codes/Orthogonal-Constrained-Gated-Sparse-Attention/orthgsa/layers/mhc.py", line 131, in compute_coefficients
    H_res = cayley_transform(H_res_raw)  # [B*L, n, n] -> orthogonal
            ^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/home/alfred/codes/Orthogonal-Constrained-Gated-Sparse-Attention/orthgsa/layers/cayley.py", line 87, in cayley_transform
    Q = torch.linalg.solve(I_plus_A, I_minus_A)
        ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
NotImplementedError: "lu_factor_cublas" not implemented for 'BFloat16'
[rank0]: Traceback (most recent call last):
[rank0]:   File "/home/alfred/codes/Orthogonal-Constrained-Gated-Sparse-Attention/scripts/train.py", line 451, in <module>
[rank0]:     main()
[rank0]:   File "/home/alfred/codes/Orthogonal-Constrained-Gated-Sparse-Attention/scripts/train.py", line 353, in main
[rank0]:     step_metrics = train_step(
[rank0]:                    ^^^^^^^^^^^
[rank0]:   File "/home/alfred/codes/Orthogonal-Constrained-Gated-Sparse-Attention/scripts/train.py", line 115, in train_step
[rank0]:     outputs = model(
[rank0]:               ^^^^^^
[rank0]:   File "/home/alfred/codes/Orthogonal-Constrained-Gated-Sparse-Attention/.venv/lib/python3.11/site-packages/torch/nn/modules/module.py", line 1775, in _wrapped_call_impl
[rank0]:     return self._call_impl(*args, **kwargs)
[rank0]:            ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
[rank0]:   File "/home/alfred/codes/Orthogonal-Constrained-Gated-Sparse-Attention/.venv/lib/python3.11/site-packages/torch/nn/modules/module.py", line 1786, in _call_impl
[rank0]:     return forward_call(*args, **kwargs)
[rank0]:            ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
[rank0]:   File "/home/alfred/codes/Orthogonal-Constrained-Gated-Sparse-Attention/.venv/lib/python3.11/site-packages/torch/distributed/fsdp/fully_sharded_data_parallel.py", line 851, in forward
[rank0]:     output = self._fsdp_wrapped_module(*args, **kwargs)
[rank0]:              ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
[rank0]:   File "/home/alfred/codes/Orthogonal-Constrained-Gated-Sparse-Attention/.venv/lib/python3.11/site-packages/torch/nn/modules/module.py", line 1775, in _wrapped_call_impl
[rank0]:     return self._call_impl(*args, **kwargs)
[rank0]:            ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
[rank0]:   File "/home/alfred/codes/Orthogonal-Constrained-Gated-Sparse-Attention/.venv/lib/python3.11/site-packages/torch/nn/modules/module.py", line 1786, in _call_impl
[rank0]:     return forward_call(*args, **kwargs)
[rank0]:            ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
[rank0]:   File "/home/alfred/codes/Orthogonal-Constrained-Gated-Sparse-Attention/orthgsa/models/orthgsa_model.py", line 341, in forward
[rank0]:     hidden_states = mhc(hidden_states, layer_fn)
[rank0]:                     ^^^^^^^^^^^^^^^^^^^^^^^^^^^^
[rank0]:   File "/home/alfred/codes/Orthogonal-Constrained-Gated-Sparse-Attention/.venv/lib/python3.11/site-packages/torch/nn/modules/module.py", line 1775, in _wrapped_call_impl
[rank0]:     return self._call_impl(*args, **kwargs)
[rank0]:            ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
[rank0]:   File "/home/alfred/codes/Orthogonal-Constrained-Gated-Sparse-Attention/.venv/lib/python3.11/site-packages/torch/nn/modules/module.py", line 1786, in _call_impl
[rank0]:     return forward_call(*args, **kwargs)
[rank0]:            ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
[rank0]:   File "/home/alfred/codes/Orthogonal-Constrained-Gated-Sparse-Attention/orthgsa/layers/mhc.py", line 204, in forward
[rank0]:     H_pre, H_post, H_res = self.compute_coefficients(x)
[rank0]:                            ^^^^^^^^^^^^^^^^^^^^^^^^^^^^
[rank0]:   File "/home/alfred/codes/Orthogonal-Constrained-Gated-Sparse-Attention/orthgsa/layers/mhc.py", line 131, in compute_coefficients
[rank0]:     H_res = cayley_transform(H_res_raw)  # [B*L, n, n] -> orthogonal
[rank0]:             ^^^^^^^^^^^^^^^^^^^^^^^^^^^
[rank0]:   File "/home/alfred/codes/Orthogonal-Constrained-Gated-Sparse-Attention/orthgsa/layers/cayley.py", line 87, in cayley_transform
[rank0]:     Q = torch.linalg.solve(I_plus_A, I_minus_A)
[rank0]:         ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
[rank0]: NotImplementedError: "lu_factor_cublas" not implemented for 'BFloat16'
